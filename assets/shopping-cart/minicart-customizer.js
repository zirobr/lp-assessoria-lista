/**
 * Minicart PayPal-link interception
 * 05.04.2016
 *
 * [ 	Minicart.js is modified - disabled cart-window popup when adding/changeing items;
 * 		html/css theme changed. ]
 *
 * Insert these lines in HTML
 * <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
 * <script src="plugins/minicart/dist/minicart.js"></script>
 * <script src="minicart-customizer.js"></script>
 *
 */
(function(){function l(c){var f=0,a=document.querySelector("#mc-shopcart"),b=document.querySelector("#mc-shopcart-qty");paypal.minicart.cart.items().forEach(function(a){f+=a._data.quantity});1==c&&setTimeout(function(){b.fadeTo(200,.25);setTimeout(function(){b.fadeTo(200,1);setTimeout(function(){b.fadeTo(200,.25);setTimeout(function(){b.fadeTo(200,1)},200)},200)},200)},200);var e;"undefined"!==typeof bootstrap?e=new bootstrap.Tooltip(a,{title:paypal.minicart.cart.total().toString(),trigger:"hover focus"}):
$.fn.Tooltip&&(e=a.tooltip({title:paypal.minicart.cart.total().toString(),trigger:"hover focus"}));0<f?(a.fadeTo(200,1),b.innerText=f?f:"","undefined"!==typeof bootstrap?e.dispose():$.fn.Tooltip&&a.tooltip("destroy"),c={},paypal.minicart.cart.subtotal(c),c=c.currency,"undefined"!==typeof bootstrap?e=new bootstrap.Tooltip(a,{title:paypal.minicart.cart.subtotal()+" "+c,trigger:"hover focus"}):$.fn.Tooltip&&a.tooltip({title:paypal.minicart.cart.subtotal()+" "+c,trigger:"hover focus"})):(b.innerText=
f?f:"",a.fadeTo(200,0),"undefined"!==typeof bootstrap?e.dispose():$.fn.Tooltip&&d.tooltip("destroy"),"undefined"!==typeof bootstrap?e=new bootstrap.Tooltip(a,{title:"Cart is Empty",trigger:"hover focus"}):$.fn.Tooltip&&a.tooltip({title:"Cart is Empty",trigger:"hover focus"}))}function r(a){var f={};decodeURIComponent(a).split("&").forEach(function(a){a=a.split("=");f[a[0]]=(a[1]||"").replace(/\+/g," ")});return f}function m(){var c;c=window.innerWidth<=a.site_width?a.side_offset:(window.innerWidth-
a.site_width)/2+a.side_offset;switch(k){case 0:d.style.left=c+"px";d.style.right="initial";break;case 1:d.style.left="initial",d.style.right=c+"px"}}function t(){if(!p&&document.body){switch(a.shopcart_position){case "left":k=0;break;case "right":k=1;break;default:console.log("Shopcart position (orientation) is wrong");return}paypal.minicart.render({strings:{button:a.checkout_button.replace(),cartTitle:a.cartTitle}});window.location.href==a.returnURL&&(paypal.minicart.reset(),window.location=window.location.origin+
window.location.pathname);var c=document.createElement("div");c.innerHTML=a.shopcartHtml;document.querySelector("body").append(c);c=document.createElement("style");c.innerHTML="#giftcard-to-shopcart {font-size: "+a.gift_icon_size+"px; color: "+a.gift_icon_color+"; background-color: "+a.gift_back_color+"}";document.querySelector("body").append(c);window.addEventListener("resize",function(){m()});l();document.querySelector("#mc-shopcart").addEventListener("click",function(a){a.stopPropagation();paypal.minicart.view.show();
paypal.minicart.view.redraw()});c=Array.from(document.querySelectorAll('[href*="cmd=_cart"]'));c=c.filter(function(a){if(-1!=a.getAttribute("href").search("www.paypal.com/cgi-bin/webscr"))return a});c.forEach(function(c){c.addEventListener("click",function(h){h.stopPropagation();h.preventDefault();n=!0;var b=c.getAttribute("href"),b=r(b.substring(b.indexOf("?")+1));result=paypal.minicart.cart.add({amount:b.amount,bn:b.bn,business:b.business,currency_code:b.currency_code,item_name:b.item_name,item_number:b.item_number,
shipping:b.shipping,shipping2:b.shipping2,"return":a.returnURL,cancel_return:a.cancel_returnURL,notifyURL:a.notifyURL,on0:b.on0,os0:b.os0,on1:b.on1,os1:b.os1,on2:b.on2,os2:b.os2});if(!1!==result&&d){d.fadeTo(200,1);var e=document.createElement("div");e.innerHTML=a.giftCardHtml;document.querySelector("body").append(e);var b=d.getBoundingClientRect().top+document.body.scrollTop,g=d.getBoundingClientRect().left+document.body.scrollLeft,k=(h.pageY-10-b)/2+b,m=(h.pageX-10-g)/2+g;e.firstChild.offsetTop=
h.pageY-10;e.firstChild.offsetLeft=h.pageX-10;e.firstChild.animate([{top:k+"px",left:m+"px",width:"50px",height:"50px",fontSize:"35px",padding:"8px"},{top:b+25+"px",left:g+20+"px",width:"21px",height:"21px",fontSize:"15px",padding:"3px"}],{duration:1E3}).onfinish=function(){e&&e.remove();l(!0)}}n=!1})});paypal.minicart.cart.on("change",function(a){n||l(!0)});paypal.minicart.cart.on("remove",function(){l()});d=document.querySelector("#mc-shopcart");d.style.top=a.shopcart_top_offset+"px";d.style.fontSize=
a.shopcart_icon_size+"px";d.style.color=a.shopcart_icon_color;d.style.backgroundColor=a.shopcart_back_color;d.querySelector("span").style.fontSize=a.sc_count_size+"px";d.querySelector("span").style.color=a.sc_count_color;d.querySelector("span").style.backgroundColor=a.sc_count_back_color;"undefined"!==typeof bootstrap?new bootstrap.Tooltip(d,{popperConfig:function(a){return{title:paypal.minicart.cart.total().toString(),trigger:"hover focus"}}}):$.fn.Tooltip&&d.tooltip({title:paypal.minicart.cart.total().toString(),
trigger:"hover focus"});shopcartWidth=d.offsetWidth;m();p=!0}}function g(c){for(var d in c)q.hasOwnProperty(d)&&(a[d]=c[d]);document.addEventListener("DOMContentLoaded",function(){t()})}var q={shopcart_position:"right",site_width:1150,side_offset:20,shopcart_top_offset:120,gift_icon_color:"#FFF",gift_back_color:"#f97352",gift_icon_size:15,shopcart_icon_color:"#FFF",shopcart_back_color:"#000",shopcart_icon_size:50,sc_count_color:"#FFF",sc_count_back_color:"#f97352",sc_count_size:12,returnURL:window.location.origin+
window.location.pathname+"?success",cancel_returnURL:window.location.origin+window.location.pathname+"?failure",shopcartCSSLink:'<link rel="stylesheet" href="shopping-cart/minicart-theme.css" type="text/css">',giftCardHtml:'<i id="giftcard-to-shopcart" class="shoppingcart-icons">&#xe308;</i>',shopcartHtml:'<i id="mc-shopcart" role="button" class="shoppingcart-icons" data-toggle="tooltip" data-placement="left">&#xe1df;<span id="mc-shopcart-qty"></span></div></i>',checkout_button:"Pay with",cartTitle:"Your Order:"},
a=q,p=!1,n=!1,d,k;Element.prototype.fadeTo=function(a,d){this.style.transitionDuration=a+"ms";this.style.opacity=d};if("undefined"===typeof paypal||"undefined"===typeof paypal.minicart)return-1;window.mcShopcartOptions&&g(window.mcShopcartOptions);"function"===typeof define&&define.amd?define(function(){return g}):"object"==typeof exports?module.exports=g:window.mcShopcart=g})();mcShopcart("undefined"===typeof shopcartSettings?null:shopcartSettings);
